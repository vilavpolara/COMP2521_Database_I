-- 1. Retrieve the student's last names and the last name of their advisor. Make
--    appropriate use of aliases.
SELECT f_first AS First_Name , f_last AS Last_Name
FROM faculty;

-- 2. Retrieve the advisor name along with the number of students they are 
--    advising.
SELECT f_first, f_last, COUNT(s_id) AS Total_Students
FROM student JOIN faculty USING (f_id)
GROUP BY f_first, f_last;

-- 3. Retrieve the last name of faculty members who are scheduled to teach 
--    course sections. Show the total maximum enrollment per faculty member. 
SELECT faculty.f_id, faculty.f_last, SUM(max_enrl)
FROM faculty, course_section
WHERE faculty.f_id = course_section.f_id
GROUP BY f_id, f_last;

-- 4. Retrieve the course ID and course name of all sections that are scheduled 
--    in the course section table and their corresponding maximum enrollment.  
--    a) Write the above query using the JOIN keyword with an ON clause.
SELECT course_section.course_id, course.course_name, course_section.max_enrl
FROM course JOIN course_section ON course.course_id = course_section.course_id;

-- 4. Retrieve the course ID and course name of all sections that are scheduled 
--    in the course section table and their corresponding maximum enrollment.  
--    b) Write the above query using the JOIN keyword with the USING clause.
SELECT course_section.course_id, course.course_name, course_section.max_enrl
FROM course JOIN course_section USING (course_id);

--------------------------------------------------------------------------------

-- 5. Modify query #4 to retrieve the total maximum enrollment per course.
SELECT cs.course_id, c.course_name, SUM(cs.max_enrl)
FROM course c JOIN course_section cs USING (course_id)
GROUP BY c.course_name;

-- 6. Modify query #5 to retrieve only those courses that have their total
--    enrollment greater than 200
SELECT cs.course_id, c.course_name, SUM(cs.max_enrl)
FROM course c JOIN course_section cs USING (course_id)
GROUP BY c.course_name
HAVING SUM(max_enrl) > 200;

-- 7. Retrieve the location ID, building code, and room of locations that have
--    been scheduled for a course section. Show the number of course sections
--    taking plase in each of those locations. Sort the result with location ID.


-- 8. Retrieve the course name, term description, faculty last name and room of
--    course sections that have been scheduled

-- 9. Run query #8. Is the new coruse section included in your result. Show as a
--    comment in SQL file

-- 10. Retrieve the course name, and the name of prerequisite course for those
--     courses that have prerequisites.

-- 11. Retrieve the first and last name of all faculty who have the same rank as
--     Kim Cox. Do not show Kim Cox in the result.

-- 12. Retrieve all student last names of those that are advised by Sarah 
--     Miller's in the result